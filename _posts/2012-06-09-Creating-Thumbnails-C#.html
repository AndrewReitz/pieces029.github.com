---
layout: post
title: Creating Thumbnails C#
date: 2012-06-09 19:39:15 UTC
updated: 2012-06-09 19:39:15 UTC
comments: false
categories: C# Thumbnails
---

<div class="MsoNormal">I was creating a website for a friend, and the photo gallery I decided to use needed thumbnails of all the pictures she had given me.&nbsp; Now rather than do this by hand, or try and use the uploader I made on the site that can only handle three pictures at a time, I decided to make a program to do this for me.<o:p></o:p></div><div class="MsoNormalCxSpMiddle">First I create a folder in the path that was specified by the user, the string folder.&nbsp; Then iterate on each file that is in the directory.<o:p></o:p></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="color: #2b91af; font-family: Consolas; font-size: 9.5pt;">Directory</span><span style="font-family: Consolas; font-size: 9.5pt;">.CreateDirectory(<span style="color: #2b91af;">Path</span>.Combine(folder, <span style="color: #a31515;">"thumbs"</span>));<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">foreach</span><span style="font-family: Consolas; font-size: 9.5pt;"> (<span style="color: blue;">string</span> pic <span style="color: blue;">in</span> <span style="color: #2b91af;">Directory</span>.GetFiles(folder))<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">{<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">switch</span><span style="font-family: Consolas; font-size: 9.5pt;"> (<span style="color: #2b91af;">Path</span>.GetExtension(pic.ToLower()))<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="font-family: Consolas; font-size: 9.5pt;">{<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">case</span> <span style="color: #a31515;">".jpg"</span>: <span style="color: blue;">break</span>;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">case</span><span style="font-family: Consolas; font-size: 9.5pt;"> <span style="color: #a31515;">".bmp"</span>: <span style="color: blue;">break</span>;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">case</span><span style="font-family: Consolas; font-size: 9.5pt;"> <span style="color: #a31515;">".gif"</span>: <span style="color: blue;">break</span>;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">case</span><span style="font-family: Consolas; font-size: 9.5pt;"> <span style="color: #a31515;">".exif"</span>: <span style="color: blue;">break</span>;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">case</span><span style="font-family: Consolas; font-size: 9.5pt;"> <span style="color: #a31515;">".png"</span>: <span style="color: blue;">break</span>;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">case</span><span style="font-family: Consolas; font-size: 9.5pt;"> <span style="color: #a31515;">".tiff"</span>: <span style="color: blue;">break</span>;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">default</span><span style="font-family: Consolas; font-size: 9.5pt;">: <span style="color: green;">// not a recognized format by <o:p></o:p></span></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">//</span><span style="color: green; font-family: Consolas; font-size: 9.5pt;">System.Drawing.Bitmap so skip and go to the next<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">continue</span><span style="font-family: Consolas; font-size: 9.5pt;">;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="font-family: Consolas; font-size: 9.5pt;">}<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">//more code to follow<o:p></o:p></span></div><div class="MsoNormalCxSpMiddle"><br /></div><div class="MsoNormalCxSpMiddle">I do some funky things to calculate the width and height that gets the images sized down to the way I want them.&nbsp; I don’t think it’s really important and if you’re trying to implement this you should feel free to calculate the ratio any way you like. &nbsp;&nbsp;Next, I create an empty bitmap to the height and width I want.&nbsp; Then use the graphics class to load in the bitmap.&nbsp; The settings SmoothingMode,&nbsp; InterpolationMode, and PixelOffsetMode are all ones I found to keep the thumbnail looking good.&nbsp; The last call with the graphics class, DrawImage is loading the image you want to resize onto the bitmap previously set up, shrinking it to fit, give you a nice thumbnail in memory. &nbsp;The last thing to do is write the image to disc.&nbsp; You can see in the code, I place the thumbnail in the thumbs directory previously created and use the name of the original file with thumb- prepended to the name.<o:p></o:p></div><div class="MsoNormalCxSpMiddle"><br /></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">using</span><span style="font-family: Consolas; font-size: 9.5pt;"> (<span style="color: #2b91af;">Bitmap</span> newImage = <span style="color: blue;">new</span> <span style="color: #2b91af;">Bitmap</span>(newWidth, newHeight))<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">{<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none; text-indent: .5in;"><span style="color: blue; font-family: Consolas; font-size: 9.5pt;">using</span><span style="font-family: Consolas; font-size: 9.5pt;"> (<span style="color: #2b91af;">Graphics</span> gr = <span style="color: #2b91af;">Graphics</span>.FromImage(newImage))<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gr.SmoothingMode = <span style="color: #2b91af;">SmoothingMode</span>.AntiAlias;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gr.InterpolationMode = <span style="color: #2b91af;">InterpolationMode</span>.HighQualityBicubic;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gr.PixelOffsetMode = <span style="color: #2b91af;">PixelOffsetMode</span>.HighQuality;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gr.DrawImage(<span style="color: blue;">new</span> <span style="color: #2b91af;">Bitmap</span>(pic), <span style="color: blue;">new</span> <span style="color: #2b91af;">Rectangle</span>(0, 0, newWidth, newHeight));<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; margin-left: .5in; margin-right: 0in; margin-top: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">}<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><br /></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> imgName = <span style="color: #2b91af;">Path</span>.GetFileName(pic); <span style="color: green;">//get the images name</span><o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green;">//write the image to thumbs directory with the thumb-imageName</span><o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newImage.Save(<span style="color: #2b91af;">Path</span>.Combine(folder, <span style="color: #a31515;">"thumbs\\thumb-"</span> + imgName));<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">}<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0in; mso-layout-grid-align: none; text-autospace: none;"><span style="font-family: Consolas; font-size: 9.5pt;">} //end foreach<o:p></o:p></span></div><div class="MsoNormalCxSpMiddle"><br /></div><div class="MsoNormalCxSpMiddle">That’s really all there is to it folks.&nbsp; If you for some reason need to create a bunch of thumbnails and don’t want to implement it yourself, <a href="http://www.megaupload.com/?d=JZRRYFPQ">here </a>is the executable I created, along with the source.<o:p></o:p></div>